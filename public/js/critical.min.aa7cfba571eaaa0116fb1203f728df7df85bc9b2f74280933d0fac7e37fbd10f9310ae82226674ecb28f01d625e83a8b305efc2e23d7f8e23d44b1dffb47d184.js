(()=>{document.addEventListener("DOMContentLoaded",function(){let e=[].slice.call(document.querySelectorAll("img.lazy, video.lazy"));if("loading"in HTMLImageElement.prototype)e.forEach(function(e){e.dataset.src&&(e.src=e.dataset.src),e.dataset.srcset&&(e.srcset=e.dataset.srcset),e.classList.remove("lazy")});else if("IntersectionObserver"in window){let t=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let n=e.target;n.dataset.src&&(n.src=n.dataset.src),n.dataset.srcset&&(n.srcset=n.dataset.srcset),n.classList.remove("lazy"),t.unobserve(n)}})},{rootMargin:"50px 0px",threshold:.01});e.forEach(function(e){t.observe(e)})}else{let n=!1;const t=function(){n===!1&&(n=!0,setTimeout(function(){e.forEach(function(n){n.getBoundingClientRect().top<=window.innerHeight&&n.getBoundingClientRect().bottom>=0&&getComputedStyle(n).display!=="none"&&(n.dataset.src&&(n.src=n.dataset.src),n.dataset.srcset&&(n.srcset=n.dataset.srcset),n.classList.remove("lazy"),e=e.filter(function(e){return e!==n}),e.length===0&&(document.removeEventListener("scroll",t),window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)))}),n=!1},200))};document.addEventListener("scroll",t),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),t()}})})(),(()=>{document.addEventListener("DOMContentLoaded",function(){document.body.classList.add("js-enabled"),console.log("DOM Content Loaded");const n=document.getElementById("sortAlpha"),s=document.getElementById("sortChrono"),o=document.getElementById("assortment"),d=document.getElementById("totalMdFiles");if(!n||!s||!o||!d){console.log("Sort buttons or assortment or totalMdFiles not found");return}console.log("Sort buttons found");let e=Array.from(o.getElementsByClassName("flex-item"));if(e.length===0){console.log("No flex items found");return}console.log(`Found ${e.length} flex items`);let t=0;function u(e){const t=e.getAttribute("data-large-src"),n=e.getAttribute("data-large-width"),s=e.getAttribute("data-large-height");t&&(e.src=t,e.setAttribute("width",n),e.setAttribute("height",s))}function r(e){e&&e.classList.toggle("active")}function r(e){e&&e.classList.toggle("active")}const c=n=>{const s=n.currentTarget,i=e.findIndex(e=>e.querySelector(".navigable-item")===s);i!==-1&&(t=i),s.classList.toggle("active");const o=s.querySelector(".image-caption");o&&(s.classList.contains("active")?(o.style.display="block",o.style.opacity="1"):(o.style.display="none",o.style.opacity="0"));const a=s.querySelector("img");a&&u(a);const c=s.querySelector(".video-container");c&&r(c),s.classList.contains("active")&&requestAnimationFrame(()=>{s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},a=()=>{e.forEach(e=>{const t=e.querySelector(".navigable-item");t&&(t.removeEventListener("click",c),t.addEventListener("click",c))})},l=()=>{console.log("Registering navigation..."),e=Array.from(o.getElementsByClassName("flex-item"))};l(),a(),document.addEventListener("keydown",function(n){if(console.log(`Keydown event: ${n.key}`),n.key==="ArrowRight"||n.key==="ArrowLeft"){const o=e[t].querySelector(".navigable-item"),i=o?o.querySelector(".image-caption"):null,r=o?o.querySelector(".video-container"):null;o&&(o.classList.remove("active"),i&&(i.style.display="none",i.style.opacity="0"),r&&r.classList.remove("active")),t=n.key==="ArrowRight"?(t+1)%e.length:(t-1+e.length)%e.length;const s=e[t].querySelector(".navigable-item"),a=s?s.querySelector(".image-caption"):null,c=s?s.querySelector(".video-container"):null,l=s.querySelector('[data-highlight="true"]');s&&(s.classList.add("active"),a&&(a.style.display="block",a.style.opacity="1"),c&&c.classList.add("active"),l&&updateMediaToLarge(s)),s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}});const i=t=>{let n;t==="alpha"?n=e.sort((e,t)=>e.dataset.title.localeCompare(t.dataset.title)):n=e.sort((e,t)=>parseInt(t.dataset.year,10)-parseInt(e.dataset.year,10)),o.innerHTML="",n.forEach((e,t)=>{o.appendChild(e);let n=e.querySelector(".image-number");n&&(n.textContent=`Fig. ${t+1}`)}),l(),a()};i("chrono"),s.classList.add("selected"),n.classList.remove("selected"),d.innerText=e.length,n.addEventListener("click",()=>{i("alpha"),n.classList.add("selected"),s.classList.remove("selected")}),s.addEventListener("click",()=>{i("chrono"),s.classList.add("selected"),n.classList.remove("selected")});const h=()=>{e.forEach(e=>{const t=e.querySelector("img");if(t){const e=t.getAttribute("data-large-src");e&&t.src!==e&&(t.src=e)}})};setTimeout(h,50);function m(){const e=document.createElement("div");e.className="typing-cursor",document.body.appendChild(e);const t=document.querySelectorAll(".image-item");let n=0;t.forEach((s,o)=>{setTimeout(()=>{const n=s.getBoundingClientRect();e.style.top=`${n.top+window.scrollY}px`,e.style.left=`${n.left}px`,setTimeout(()=>{s.classList.add("typed")},19),o===t.length-1&&setTimeout(()=>{e.remove()},47)},n),n+=28})}m()})})()