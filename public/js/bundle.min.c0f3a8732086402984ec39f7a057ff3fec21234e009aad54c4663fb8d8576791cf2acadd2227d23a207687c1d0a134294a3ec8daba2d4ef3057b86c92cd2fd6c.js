(()=>{document.addEventListener("DOMContentLoaded",function(){var e=[].slice.call(document.querySelectorAll("img.lazy"));if("IntersectionObserver"in window){let t=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting)e.target.removeAttribute("loading");else{let n=e.target;n.setAttribute("loading","lazy"),t.unobserve(n)}})},{rootMargin:"0px 0px -200px 0px"});e.forEach(function(e){t.observe(e)})}})})(),(()=>{document.addEventListener("DOMContentLoaded",function(){console.log("DOM Content Loaded");const n=document.getElementById("sortAlpha"),s=document.getElementById("sortChrono"),o=document.getElementById("assortment"),d=document.getElementById("totalMdFiles");if(!n||!s||!o||!d){console.log("Sort buttons or assortment or totalMdFiles not found");return}console.log("Sort buttons found");let e=Array.from(o.getElementsByClassName("flex-item"));if(e.length===0){console.log("No flex items found");return}console.log(`Found ${e.length} flex items`);let t=0;function u(e){const t=e.getAttribute("data-large-src"),n=e.getAttribute("data-large-width"),s=e.getAttribute("data-large-height");t&&(e.src=t,e.setAttribute("width",n),e.setAttribute("height",s))}function r(e){e&&e.classList.toggle("active")}function r(e){e&&e.classList.toggle("active")}const c=n=>{const s=n.currentTarget,i=e.findIndex(e=>e.querySelector(".navigable-item")===s);i!==-1&&(t=i),s.classList.toggle("active");const o=s.querySelector(".image-caption");o&&(s.classList.contains("active")?(o.style.display="block",o.style.opacity="1"):(o.style.display="none",o.style.opacity="0"));const a=s.querySelector("img");a&&u(a);const c=s.querySelector(".video-container");c&&r(c),s.classList.contains("active")&&requestAnimationFrame(()=>{s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},a=()=>{e.forEach(e=>{const t=e.querySelector(".navigable-item");t&&(t.removeEventListener("click",c),t.addEventListener("click",c))})},l=()=>{console.log("Registering navigation..."),e=Array.from(o.getElementsByClassName("flex-item"))};l(),a(),document.addEventListener("keydown",function(n){if(console.log(`Keydown event: ${n.key}`),n.key==="ArrowRight"||n.key==="ArrowLeft"){const o=e[t].querySelector(".navigable-item"),i=o?o.querySelector(".image-caption"):null,r=o?o.querySelector(".video-container"):null;o&&(o.classList.remove("active"),i&&(i.style.display="none",i.style.opacity="0"),r&&r.classList.remove("active")),t=n.key==="ArrowRight"?(t+1)%e.length:(t-1+e.length)%e.length;const s=e[t].querySelector(".navigable-item"),a=s?s.querySelector(".image-caption"):null,c=s?s.querySelector(".video-container"):null,l=s.querySelector('[data-highlight="true"]');s&&(s.classList.add("active"),a&&(a.style.display="block",a.style.opacity="1"),c&&c.classList.add("active"),l&&updateMediaToLarge(s)),s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}});const i=t=>{let n;t==="alpha"?n=e.sort((e,t)=>e.dataset.title.localeCompare(t.dataset.title)):n=e.sort((e,t)=>parseInt(t.dataset.year,10)-parseInt(e.dataset.year,10)),o.innerHTML="",n.forEach((e,t)=>{o.appendChild(e);let n=e.querySelector(".overlay-caption");if(n){const e=n.textContent.replace(/^\d+\.\s*/,"");n.textContent=`${t+1}`}let s=e.querySelector(".image-number");s&&(s.textContent=`Fig. ${t+1}`)}),l(),a()};i("chrono"),s.classList.add("selected"),n.classList.remove("selected"),d.innerText=e.length,n.addEventListener("click",()=>{i("alpha"),n.classList.add("selected"),s.classList.remove("selected")}),s.addEventListener("click",()=>{i("chrono"),s.classList.add("selected"),n.classList.remove("selected")});const h=()=>{e.forEach(e=>{const t=e.querySelector("img");if(t){const e=t.getAttribute("data-large-src");e&&t.src!==e&&(t.src=e)}})};setTimeout(h,50)})})(),(()=>{document.addEventListener("DOMContentLoaded",e=>{console.log("DOMContentLoaded event triggered");const t=document.querySelector(".toggle-bio"),n=document.querySelector(".bio-expand"),s=document.querySelector(".arrow");console.log("toggleBio:",t),console.log("bioExpand:",n),console.log("arrow:",s),t&&n&&s&&t.addEventListener("click",e=>{console.log("toggleBio clicked"),e.preventDefault(),n.classList.toggle("hidden"),n.classList.contains("hidden")?t.textContent="Show more ↓":t.textContent="Show less ↑"})})})(),(()=>{function t(){const n=document.getElementById("search-input").value;document.getElementById("clear-search-btn").classList.toggle("hidden",!n);const s=document.querySelectorAll("#assortment .flex-item");if(n.trim()===""){s.forEach(e=>{e.style.display="block"});return}const o=e.search(n);console.log("Search results:",o);const t=new Set;o.forEach(e=>{e.item.images.forEach(e=>{t.add(e.url)}),e.item.videos.forEach(e=>{t.add(e.url)})}),console.log("Results Set:",t),s.forEach(e=>{const n=e.getAttribute("data-url");t.has(n)?e.style.display="block":e.style.display="none"})}var e;fetch("/index.json").then(e=>e.json()).then(t=>{e=new Fuse(t,{keys:["title","description","year","role","collaborators","images.caption","videos.caption","tags","location","alt"],threshold:.1}),console.log("Fuse instance:",e)}),document.getElementById("search-input").addEventListener("input",t),document.getElementById("clear-search-btn").addEventListener("click",()=>{const e=document.getElementById("search-input");e.value="",t()})})(),(()=>{var n,e=new Map,t=new Map;function i(){return"ontouchstart"in window||navigator.maxTouchPoints>0}function s(){return"#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}function a(){const e="duotone-"+Math.random().toString(36).substr(2,9),n=s(),o=s(),t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("style","width:0;height:0;position:absolute;"),t.innerHTML=`
        <defs>
            <filter id="${e}">
                <feColorMatrix type="matrix" values="0.3333 0.3333 0.3333 0 0
                    0.3333 0.3333 0.3333 0 0
                    0.3333 0.3333 0.3333 0 0
                    0 0 0 1 0"/>
                <feComponentTransfer color-interpolation-filters="sRGB">
                    <feFuncR type="table" tableValues="0 1"/>
                    <feFuncG type="table" tableValues="0 1"/>
                    <feFuncB type="table" tableValues="0 1"/>
                </feComponentTransfer>
                <feColorMatrix type="matrix" values="1 0 0 0 0
                    0 1 0 0 0
                    0 0 1 0 0
                    0 0 0 1 0"/>
                <feComponentTransfer color-interpolation-filters="sRGB">
                    <feFuncR type="linear" slope="1" intercept="0"/>
                    <feFuncG type="linear" slope="1" intercept="0"/>
                    <feFuncB type="linear" slope="1" intercept="0"/>
                </feComponentTransfer>
                <feFlood flood-color="${n}" result="color1"/>
                <feFlood flood-color="${o}" result="color2"/>
                <feComposite operator="arithmetic" in="color1" in2="SourceAlpha" k1="1" k2="0" k3="0" k4="0" result="c1"/>
                <feComposite operator="arithmetic" in="color2" in2="SourceAlpha" k1="0" k2="1" k3="0" k4="0" result="c2"/>
                <feBlend mode="multiply" in="c1" in2="c2"/>
            </filter>
        </defs>
    `,document.getElementById(e)||document.body.appendChild(t),e}function o(n){if(!t.has(n)){const e=a(n);t.set(n,e)}e.has(n)||e.set(n,{filter:n.style.filter,transition:n.style.transition});const s=t.get(n);n.style.filter=`url(#${s})`}function r(){document.querySelectorAll("img").forEach(function(e){e.complete?o(e):e.onload=()=>o(e)})}function c(){document.querySelectorAll("img").forEach(function(t){const n=e.get(t);n&&(t.style.filter=n.filter||"none")})}document.addEventListener("DOMContentLoaded",function(){i()||window.addEventListener("mousemove",function(){c(),clearTimeout(n),n=setTimeout(r,1e3)})})})()